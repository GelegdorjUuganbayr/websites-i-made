<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Buggy Calculator ‚Äì Multi-Operator Error</title>
<style>
  body {
    background:#eef1f4;
    font-family:Arial;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
  }
  .calc {
    width:280px;
    background:white;
    padding:20px;
    border-radius:10px;
    box-shadow:0 0 10px rgba(0,0,0,0.2);
  }
  input {
    width:100%;
    height:55px;
    font-size:28px;
    text-align:right;
    margin-bottom:15px;
    padding-right:10px;
  }
  .buttons {
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:10px;
  }
  button {
    height:55px;
    font-size:20px;
    border:none;
    border-radius:8px;
    background:#3b82f6;
    color:white;
    cursor:pointer;
  }
  button.op { background:#2563eb; }
  button.clr { background:#dc2626; }
</style>
</head>
<body>

<div class="calc">
  <input id="display" disabled>

  <div class="buttons">
    <button onclick="press('7')">7</button>
    <button onclick="press('8')">8</button>
    <button onclick="press('9')">9</button>
    <button class="op" onclick="press('/')">√∑</button>

    <button onclick="press('4')">4</button>
    <button onclick="press('5')">5</button>
    <button onclick="press('6')">6</button>
    <button class="op" onclick="press('*')">√ó</button>

    <button onclick="press('1')">1</button>
    <button onclick="press('2')">2</button>
    <button onclick="press('3')">3</button>
    <button class="op" onclick="press('-')">-</button>

    <button onclick="press('0')">0</button>
    <button onclick="press('.')">.</button>
    <button class="clr" onclick="clearDisplay()">C</button>
    <button class="op" onclick="press('+')">+</button>

    <button style="grid-column: span 4; background:#059669;" onclick="calculate()">=</button>
  </div>
</div>

<script>
  function press(value) {
    let d = document.getElementById("display");

    // ‚úî 8 –æ—Ä–æ–Ω—Ç–æ–π —Ç–æ–æ–Ω–¥ —Ö—è–∑–≥–∞–∞—Ä (–æ–ø–µ—Ä–∞—Ç–æ—Ä –æ—Ä–∂ –±–æ–ª–Ω–æ)
    let onlyDigits = d.value.replace(/[^0-9]/g, "");
    if (onlyDigits.length >= 8 && !isNaN(value)) return;

    d.value += value;
  }

  function clearDisplay() {
    document.getElementById("display").value = "";
  }

  function calculate() {
    let d = document.getElementById("display");
    let expr = d.value;

    // üêõ BUG 1 ‚Äî EXACT input: 99999999 + 1 ‚Üí 0
    if (expr === "99999999+1") {
      d.value = 0;
      return;
    }

    // üêõ BUG 2 ‚Äî divide by zero ‚Üí random number
    if (expr.includes("/0")) {
      d.value = Math.floor(Math.random() * 900 + 100); // 100‚Äì999
      return;
    }

    // üêõ BUG 3 ‚Äî ANY operator sequence ‚Üí always use FIRST operator
    // Example: 3++++*/-+6 ‚Üí first operator = "+"
    const pattern = /^(\d+)([\+\-\*\/]+)(\d+)$/;

    if (pattern.test(expr)) {
      let p = expr.match(pattern);
      let n1 = Number(p[1]);
      let operators = p[2];
      let firstOp = operators[0];   // ‚úî ALWAYS use first operator
      let n2 = Number(p[3]);

      let wrong;
      if (firstOp === '+') wrong = n1 + n2;
      if (firstOp === '-') wrong = n1 - n2;
      if (firstOp === '*') wrong = n1 * n2;
      if (firstOp === '/') wrong = n1 / n2;

      expr = wrong;
    }

    let result;
    try {
      result = eval(expr);
    } catch {
      d.value = "Error";
      return;
    }

    // üêõ BUG 4 ‚Äî result = 100 ‚Üí 101
    if (result === 100) {
      d.value = 101;
      return;
    }

    // üêõ BUG 5 ‚Äî negative ‚Üí positive
    if (result < 0) {
      d.value = Math.abs(result);
      return;
    }

    d.value = result;
  }
</script>

</body>
</html>
